services:
  orchestrator:
    build: ./orchestrator
    container_name: trading-agent-system-orchestrator-1
    env_file: .env
    networks:
      - trading-network
    depends_on:
      technical-analyzer-agent:
        condition: service_healthy
      fibonacci-cyclical-agent:
        condition: service_healthy
      gann-analyzer-agent:
        condition: service_healthy
      news-sentiment-agent:
        condition: service_healthy
      master-ai-agent:
        condition: service_healthy
      position-manager-agent:
        condition: service_healthy

  technical-analyzer-agent:
    build: ./agents/01_technical_analyzer_agent
    container_name: trading-agent-system-technical-analyzer-agent-1
    ports: [ "8002:8000" ]
    env_file: .env
    networks: [ trading-network ]
    healthcheck:
      test: [ "CMD", "curl", "-f", "http://localhost:8000/health" ]
      interval: 15s
      timeout: 10s
      retries: 5

  fibonacci-cyclical-agent:
    build: ./agents/03_fibonacci_cyclical_agent
    container_name: trading-agent-system-fibonacci-cyclical-agent-1
    ports: [ "8003:8000" ]
    env_file: .env
    networks: [ trading-network ]
    healthcheck:
      test: [ "CMD", "curl", "-f", "http://localhost:8000/health" ]
      interval: 15s
      timeout: 10s
      retries: 5

  gann-analyzer-agent:
    build: ./agents/05_gann_analyzer_agent
    container_name: trading-agent-system-gann-analyzer-agent-1
    ports: [ "8005:8000" ]
    env_file: .env
    networks: [ trading-network ]
    healthcheck:
      test: [ "CMD", "curl", "-f", "http://localhost:8000/health" ]
      interval: 15s
      timeout: 10s
      retries: 5

  news-sentiment-agent:
    build: ./agents/06_news_sentiment_agent
    container_name: trading-agent-system-news-sentiment-agent-1
    ports: [ "8006:8000" ]
    env_file: .env
    networks: [ trading-network ]
    healthcheck:
      test: [ "CMD", "curl", "-f", "http://localhost:8000/health" ]
      interval: 15s
      timeout: 10s
      retries: 5

  master-ai-agent:
    build: ./agents/04_master_ai_agent
    container_name: trading-agent-system-master-ai-agent-1
    ports: [ "8004:8000" ]
    env_file: .env
    networks: [ trading-network ]
    healthcheck:
      test: [ "CMD", "curl", "-f", "http://localhost:8000/health" ]
      interval: 15s
      timeout: 10s
      retries: 5

  position-manager-agent:
    build: ./agents/07_position_manager_agent
    container_name: trading-agent-system-position-manager-agent-1
    ports: [ "8007:8000" ]
    env_file: .env
    networks: [ trading-network ]
    healthcheck:
      test: [ "CMD", "curl", "-f", "http://localhost:8000/health" ]
      interval: 15s
      timeout: 10s
      retries: 5

networks:
  trading-network:
    driver: bridge
